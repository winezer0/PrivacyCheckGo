rules:
  - group: People Information
    rule:
      - name: Email
        loaded: true
        f_regex: (([a-z0-9]+[_|\.])*[a-z0-9]+@([a-z0-9]+[-|_|\.])*[a-z0-9]+\.((?!js|css|jpg|jpeg|png|ico)[a-z]{2,5}))
        s_regex: ''
        format: '{0}'
        color: yellow
        scope: response
        engine: nfa
        sensitive: false
        sample_code: "contact@example.com user.name@domain.co.uk"
      - name: Chinese IDCard
        loaded: true
        f_regex: '[^0-9]((\d{8}(0\d|10|11|12)([0-2]\d|30|31)\d{3}$)|(\d{6}(18|19|20)\d{2}(0[1-9]|10|11|12)([0-2]\d|30|31)\d{3}(\d|X|x)))[^0-9]'
        s_regex: ''
        format: '{0}'
        color: orange
        scope: response body
        engine: nfa
        sensitive: true
        sample_code: "ID: 110101199001011234 Card: 11010119900101123X"
      - name: Chinese Mobile Number
        loaded: true
        f_regex: '[^\w]((?:(?:\+|0{0,2})86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8})[^\w]'
        s_regex: ''
        format: '{0}'
        color: orange
        scope: response body
        engine: nfa
        sensitive: false
        sample_code: "+8613812345678 13987654321"
      - name: Mobile Number Field
        loaded: true
        f_regex: '(((|\\)(|''|")(|[\w]{1,10})(mobile|phone|sjh|shoujihao|concat)(|[\.\w]{1,10})(|\\)(|''|")(
      |)(:|=|!=|[\)]{0,1}\.val\()( |)(|\\)(''|")([^''"]+?)(|\\)(''|")(|,|\)))|((|\\)(''|")([^''"]+?)(|\\)(''|")(|\\)(|''|")(
      |)(:|[=]{1,3}|![=]{1,2})( |)(|[\.\w]{1,10})(mobile|phone|sjh|shoujihao|concat)(|[\.\w]{1,10})(|\\)(|''|"))) '
        s_regex: ''
        format: '{0}'
        color: green
        scope: response body
        engine: nfa
        sensitive: false
        sample_code: "mobile=\"13812345678\" phone: \"13987654321\" sjh=\"13712345678\""
  - group: System Information
    rule:
      - name: Internal IP Address
        loaded: true
        f_regex: '[^0-9]((127\.0\.0\.1)|(10\.\d{1,3}\.\d{1,3}\.\d{1,3})|(172\.((1[6-9])|(2\d)|(3[01]))\.\d{1,3}\.\d{1,3})|(192\.168\.\d{1,3}\.\d{1,3}))'
        s_regex: ''
        format: '{0}'
        color: cyan
        scope: response
        engine: nfa
        sensitive: true
        sample_code: "Server: 192.168.1.100 Host: 10.0.0.1 Local: 127.0.0.1"
      - name: MAC Address
        loaded: true
        f_regex: (^([a-fA-F0-9]{2}(:[a-fA-F0-9]{2}){5})|[^a-zA-Z0-9]([a-fA-F0-9]{2}(:[a-fA-F0-9]{2}){5}))
        s_regex: ''
        format: '{0}'
        color: green
        scope: response
        engine: nfa
        sensitive: true
        sample_code: "MAC: 00:1B:44:11:3A:B7"
      - name: Windows File/Dir Path
        loaded: true
        f_regex: '[^\w]([a-zA-Z]:\\\\?(?:[^<>:/\\|?*]+\\\\?)*)([^<>:/\\|?*]+(?:\.[^<>:/\\|?*]+)?)'
        s_regex: ''
        format: '{0}'
        color: green
        scope: response
        engine: nfa
        sensitive: true
        sample_code: "Path: C:\\Windows\\System32\\ File: D:\\Documents\\file.txt"
      - name: JDBC Connection
        loaded: true
        f_regex: (jdbc:[a-z:]+://[a-z0-9\.\-_:;=/@?,&]+)
        s_regex: ''
        format: '{0}'
        color: yellow
        scope: any
        engine: nfa
        sensitive: false
        sample_code: "jdbc:mysql://localhost:3306/testdb?user=root&password=123456"
      - name: Authorization Header
        loaded: true
        f_regex: ((basic [a-zA-Z0-9=:_\+\/-]{5,100})|(bearer [a-zA-Z0-9_.=:_\+\/-]{5,100}))
        s_regex: ''
        format: '{0}'
        color: yellow
        scope: response body
        engine: nfa
        sensitive: false
        sample_code: "basic YWRtaW46cGFzc3dvcmQ= bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"
  - group: Sensitive Information
    rule:
      - name: Cloud Key
        loaded: true
        f_regex: (((access)(|-|_)(key)(|-|_)(id|secret))|(LTAI[a-z0-9]{12,20}))
        s_regex: ''
        format: '{0}'
        color: yellow
        scope: any
        engine: nfa
        sensitive: false
        sample_code: "access_key_id=AKIAIOSFODNN7EXAMPLE secret_access_key=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY LTAI5t7Y3Qw5b4u8r9t0y1u2i3o4p5a6s7d8f"
      - name: Password Field
        loaded: true
        f_regex: (((|\\)(|'|")(|[\.\w]{1,10})([p](ass|wd|asswd|assword))(|[\.\w]{1,10})(|\\)(|'|")(
          |)(:|[=]{1,3}|![=]{1,2}|[\)]{0,1}\.val\()( |)(|\\)('|")([^'"]+?)(|\\)('|")(|,|\)))|((|\\)('|")([^'"]+?)(|\\)('|")(|\\)(|'|")(
          |)(:|[=]{1,3}|![=]{1,2})( |)(|[\.\w]{1,10})([p](ass|wd|asswd|assword))(|[\.\w]{1,10})(|\\)(|'|")))
        s_regex: ''
        format: '{0}'
        color: yellow
        scope: response body
        engine: nfa
        sensitive: false
        sample_code: "password=\"MySecretPassword123\" user.password = \"test123456\" pwd: \"securePassword\""
      - name: Username Field
        loaded: true
        f_regex: (((|\\)(|'|")(|[\.\w]{1,10})(([u](ser|name|sername))|(account)|((((create|update)((d|r)|(by|on|at)))|(creator))))(|[\.\w]{1,10})(|\\)(|'|")(
          |)(:|=|!=|[\)]{0,1}\.val\()( |)(|\\)('|")([^'"]+?)(|\\)('|")(|,|\)))|((|\\)('|")([^'"]+?)(|\\)('|")(|\\)(|'|")(
          |)(:|[=]{1,3}|![=]{1,2})( |)(|[\.\w]{1,10})(([u](ser|name|sername))|(account)|((((create|update)((d|r)|(by|on|at)))|(creator))))(|[\.\w]{1,10})(|\\)(|'|")))
        s_regex: ''
        format: '{0}'
        color: green
        scope: response body
        engine: nfa
        sensitive: false
        sample_code: "username=\"admin\" user.name = \"John Doe\" account: \"johndoe\""
      - name: WeCom Key
        loaded: true
        f_regex: ((corp)(id|secret))
        s_regex: ''
        format: '{0}'
        color: green
        scope: response body
        engine: dfa
        sensitive: false
        sample_code: "corpid=ww1234567890abcdef corpsecret=1234567890abcdef1234567890abcdef"
      - name: Sensitive Field
        loaded: true
        f_regex: (((\[)?('|")?([\.\w]{0,10})(key|secret|token|config|auth|access|admin|ticket)([\.\w]{0,10})('|")?(\])?(
          |)(:|=|!=|[\)]{0,1}\.val\()( |)('|")([^'"]+?)('|")(|,|\)))|((|\\)('|")([^'"]+?)(|\\)('|")(|\\)(|'|")(
          |)(:|[=]{1,3}|![=]{1,2})( |)(|[\.\w]{1,10})(key|secret|token|config|auth|access|admin|ticket)(|[\.\w]{1,10})(|\\)(|'|")))
        s_regex: ''
        format: '{0}'
        color: yellow
        scope: response
        engine: nfa
        sensitive: false
        sample_code: "api_key=\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\" secret=\"mysecret123\" token=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\""
  - group: URL Information
    rule:
      - name: Linkfinder
        loaded: true
        f_regex: (?:"|')(((?:[a-zA-Z]{1,10}://|//)[^"'/]{1,}\.[a-zA-Z]{2,}[^"']{0,})|((?:/|\.\./|\./)[^"'><,;|*()(%%$^/\\\[\]][^"'><,;|()]{1,})|([a-zA-Z0-9_\-/]{1,}/[a-zA-Z0-9_\-/]{1,}\.(?:[a-zA-Z]{1,4}|action)(?:[\?|#][^"|']{0,}|))|([a-zA-Z0-9_\-/]{1,}/[a-zA-Z0-9_\-/]{3,}(?:[\?|#][^"|']{0,}|))|([a-zA-Z0-9_\-]{1,}\.(?:\w)(?:[\?|#][^"|']{0,}|)))(?:"|')
        s_regex: ''
        format: '{0}'
        color: gray
        scope: response body
        engine: nfa
        sensitive: true
        sample_code: '"https://example.com" "//cdn.example.com/js/main.js" "/api/users" "../images/logo.png"'
      - name: Source Map
        loaded: true
        f_regex: (\.js\.map)
        s_regex: ''
        format: '{0}'
        color: pink
        scope: response body
        engine: dfa
        sensitive: false
        sample_code: "main.js.map bundle.min.js.map"
      - name: Create Script
        loaded: true
        f_regex: (\{[^}]*\}\s*\[[^\]]*\]\s*\+\s*["'][^"']*\.js["'])
        s_regex: '"?([\w].*?)"?:"(.*?)"'
        format: '{0}.{1}'
        color: green
        scope: response body
        engine: nfa
        sensitive: false
        sample_code: "{path: 'api', method: 'get'}[0] + '.js' {route: 'user', action: 'list'}[1] + '.js'"
      - name: URL Schemes
        loaded: true
        f_regex: (\b(?![\w]{0,10}?https?://)(([A-Za-z0-9-\.]{1,20})://([-\w+&@#/%?=~_|!:,.;]*[-\w+&@#/%=~_|])?))
        s_regex: ''
        format: '{0}'
        color: yellow
        scope: response body
        engine: nfa
        sensitive: false
        sample_code: "mailto:user@example.com tel:+1234567890 file:///C:/path/to/file.txt"
      - name: Router Push
        loaded: true
        f_regex: (\$router\.push)
        s_regex: ''
        format: '{0}'
        color: magenta
        scope: response body
        engine: dfa
        sensitive: false
        sample_code: "$router.push('/home') $router.push({path: '/profile'})"
      - name: All URL
        loaded: true
        f_regex: (https?://[-A-Za-z0-9+&@#/%?=~_|!:,.;\u4E00-\u9FFF]+[-A-Za-z0-9+&@#/%=~_|])
        s_regex: ''
        format: '{0}'
        color: gray
        scope: response body
        engine: nfa
        sensitive: true
        sample_code: "https://example.com https://www.google.com/search?q=privacy https://测试.example.com"
      - name: Request URI
        loaded: true
        f_regex: ' ((?!.*\.js(\?.*)?$)(.*?[^.js$])) '
        s_regex: ''
        format: '{0}'
        color: gray
        scope: request line
        engine: nfa
        sensitive: false
        sample_code: "GET /api/users HTTP/1.1 GET /profile HTTP/1.1"
      - name: 302 Location
        loaded: true
        f_regex: 'Location: (.*?)\n'
        s_regex: ''
        format: '{0}'
        color: gray
        scope: response header
        engine: nfa
        sensitive: false
        sample_code: "Location: https://example.com\n"
